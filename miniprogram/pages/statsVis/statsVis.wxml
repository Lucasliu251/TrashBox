<view class="container">
    <scroll-view scroll-y class="dashboard">
        <view class="profile-card">
            <view class="playtime-tag">
                <text class="label">游戏时长</text>
                <text class="value">{{ userData.timePlayed }}h</text>
            </view>
            <view class="profile-info">
                <image class="avatar" src="{{ userData.avatar }}" mode="aspectFill"></image>
                <view class="text-group">
                    <text class="nickname">{{ userData.nickname }}</text>
                    <view class="level-badge">
                        <text>ID: {{ userInfo.steam_id || '---' }}</text>
                    </view>
                </view>
            </view>
        </view>
        <view class="stats-grid">
            <view class="stat-box">
                <text class="stat-label">Avg K/D (30d)</text>
                <view class="stat-value {{ userData.kd >= 1.2 ? 'gold' : '' }}">
                    {{ userData.kd }}
                </view>
            </view>
            <view class="stat-box">
                <text class="stat-label">Total Kills</text>
                <text class="stat-value">{{ userData.totalKills }}</text>
            </view>
            <view class="stat-box">
                <text class="stat-label">ADR</text>
                <text class="stat-value">{{ userData.adr }}</text>
            </view>
            <view class="stat-box">
                <text class="stat-label">Win Rate</text>
                <text class="stat-value">{{ userData.winRate }}</text>
            </view>
        </view>
        <view class="section-title">近期状态 (KD Trend)</view>
        <view class="chart-container">
            <canvas type="2d" id="trendCanvas" style="width: 100%; height: 100%;" bindtouchstart="onTouchChartStart" bindtouchmove="onTouchChartMove" bindtouchend="onTouchChartEnd"></canvas>
        </view>
        <view style="text-align: center; color: #666; font-size: 20rpx; margin-top: -20rpx; margin-bottom: 30rpx;">
            ← 左右滑动查看历史 · 点击查看详情 →
        </view>
        <view class="section-title">每日战报 (Daily Log)</view>
        <view class="match-list">
            <block wx:for="{{ matchHistory }}" wx:key="date">
                <view class="match-item">
                    <view class="match-left">
                        <view class="map-tag">{{ item.date }}</view>
                        <text class="sub-label">{{ item.rounds }} Rnds</text>
                    </view>
                    <view class="match-center-main">
                        <text class="score">{{ item.score }}</text>
                        <view class="tag-row">
                            <view class="kd-tag {{ item.kd >= 1.0 ? 'pos' : 'neg' }}">
                                {{ item.kd }} KD
                            </view>
                        </view>
                    </view>
                    <view class="match-right-grid">
                        <view class="grid-row">
                            <text class="stat-mini">
                                ADR:
                                <text class="val">{{ item.adr }}</text>
                            </text>
                            <text class="stat-mini">
                                MVP:
                                <text class="val gold">{{ item.mvp }}</text>
                            </text>
                        </view>
                        <view class="grid-row">
                            <text class="stat-mini">
                                HS%:
                                <text class="val">{{ item.hsr }}%</text>
                            </text>
                            <text class="stat-mini">
                                DMG:
                                <text class="val">{{ item.dmg }}</text>
                            </text>
                        </view>
                    </view>
                </view>
            </block>
            <view wx:if="{{matchHistory.length === 0}}" style="text-align:center; color:#666; padding:20rpx;">
                暂无比赛记录
            </view>
        </view>
    </scroll-view>
</view>